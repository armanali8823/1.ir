<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø«Ø¨Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯ÙˆØ±Ø¨ÛŒÙ†</title>
<style>
    body {
        font-family: Tahoma, sans-serif;
        direction: rtl;
        background: #f5f5f5;
        padding: 20px;
        text-align: center;
    }
    h1 {
        margin-bottom: 20px;
        color: #333;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        background: #fff;
        margin-top: 20px;
    }
    table, th, td {
        border: 1px solid #000;
    }
    th, td {
        padding: 8px;
        text-align: center;
    }
    input {
        padding: 8px;
        margin: 5px 0;
        width: 95%;
        max-width: 300px;
    }
    button {
        padding: 8px 15px;
        margin: 8px 0;
        cursor: pointer;
        border-radius: 8px;
        border: none;
        background: #1976d2;
        color: white;
    }
    button:hover {
        background: #0d47a1;
    }
</style>
</head>
<body>

<h1>Ø«Ø¨Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯ÙˆØ±Ø¨ÛŒÙ†</h1>

<div>
    <input type="text" id="brand" placeholder="Ø¨Ø±Ù†Ø¯">
    <input type="text" id="model" placeholder="Ù…Ø¯Ù„">
    <input type="text" id="ip" placeholder="IP">
    <input type="text" id="mac" placeholder="MAC Address">
    <input type="text" id="number" placeholder="Ø´Ù…Ø§Ø±Ù‡">
    <input type="text" id="assetCode" placeholder="Ú©Ø¯ Ø§Ù…ÙˆØ§Ù„">
    <br>
    <button onclick="addData()">â• Ø§ÙØ²ÙˆØ¯Ù†</button>
</div>

<table id="dataTable">
    <thead>
        <tr>
            <th>Ø¨Ø±Ù†Ø¯</th>
            <th>Ù…Ø¯Ù„</th>
            <th>IP</th>
            <th>MAC Address</th>
            <th>Ø´Ù…Ø§Ø±Ù‡</th>
            <th>Ú©Ø¯ Ø§Ù…ÙˆØ§Ù„</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<button onclick="exportExcel()">ğŸ“¥ Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„</button>
<button onclick="clearData()">ğŸ—‘ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
    let data = JSON.parse(localStorage.getItem("cameraData")) || [];

    function renderTable() {
        let tableBody = document.querySelector("#dataTable tbody");
        tableBody.innerHTML = "";
        data.forEach(item => {
            let row = tableBody.insertRow();
            row.insertCell(0).innerText = item.Ø¨Ø±Ù†Ø¯;
            row.insertCell(1).innerText = item.Ù…Ø¯Ù„;
            row.insertCell(2).innerText = item.IP;
            row.insertCell(3).innerText = item["MAC Address"];
            row.insertCell(4).innerText = item.Ø´Ù…Ø§Ø±Ù‡;
            row.insertCell(5).innerText = item["Ú©Ø¯ Ø§Ù…ÙˆØ§Ù„"];
        });
    }

    function addData() {
        let brand = document.getElementById("brand").value;
        let model = document.getElementById("model").value;
        let ip = document.getElementById("ip").value;
        let mac = document.getElementById("mac").value;
        let number = document.getElementById("number").value;
        let assetCode = document.getElementById("assetCode").value;

        if (!brand || !model || !ip || !mac || !number || !assetCode) {
            alert("Ù„Ø·ÙØ§ Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯!");
            return;
        }

        data.push({
            Ø¨Ø±Ù†Ø¯: brand,
            Ù…Ø¯Ù„: model,
            IP: ip,
            "MAC Address": mac,
            Ø´Ù…Ø§Ø±Ù‡: number,
            "Ú©Ø¯ Ø§Ù…ÙˆØ§Ù„": assetCode
        });

        localStorage.setItem("cameraData", JSON.stringify(data));
        renderTable();

        document.getElementById("brand").value = "";
        document.getElementById("model").value = "";
        document.getElementById("ip").value = "";
        document.getElementById("mac").value = "";
        document.getElementById("number").value = "";
        document.getElementById("assetCode").value = "";
    }

    function exportExcel() {
        if (data.length === 0) {
            alert("Ù‡ÛŒÚ† Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯!");
            return;
        }
        let ws = XLSX.utils.json_to_sheet(data);
        for (let cell in ws) {
            if (cell[0] === '!') continue;
            ws[cell].s = { alignment: { horizontal: "right" } };
        }
        let wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Ø¯ÙˆØ±Ø¨ÛŒÙ†â€ŒÙ‡Ø§");
        XLSX.writeFile(wb, "camera_data.xlsx");
    }

    function clearData() {
        if (confirm("Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ")) {
            data = [];
            localStorage.removeItem("cameraData");
            renderTable();
        }
    }

    // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø¬Ø¯ÙˆÙ„ Ø§Ø² LocalStorage
    renderTable();
</script>

</body>
</html>
