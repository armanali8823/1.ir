<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø³Ø§Ù…Ø§Ù†Ù‡ Ú©Ø¯Ú¯Ø°Ø§Ø±ÛŒ ÙˆØ³Ø§ÛŒÙ„ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù‚ÙØ³Ù‡</title>
<style>
  body {
    font-family: Tahoma, sans-serif;
    direction: rtl;
    background-color: #f0f0f0;
    padding: 20px;
    text-align: center;
  }
  .container {
    background: #fff;
    max-width: 700px;
    margin: 20px auto;
    padding: 25px 30px;
    border-radius: 10px;
    box-shadow: 0 0 10px #ccc;
  }
  form {
    display: flex;
    flex-direction: column;
    gap: 15px;
    align-items: flex-start;
  }
  label {
    font-weight: bold;
    margin-bottom: 5px;
  }
  input {
    padding: 7px 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 14px;
    width: 100%;
    direction: ltr;
    box-sizing: border-box;
  }
  button {
    background-color: #4CAF50;
    border: none;
    color: white;
    padding: 9px 18px;
    font-size: 16px;
    cursor: pointer;
    border-radius: 6px;
    align-self: center;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  button.search-btn {
    background-color: #0288d1;
    margin-bottom: 10px;
    padding: 10px 25px;
  }
  button.export-btn {
    background-color: #f57c00;
    margin-bottom: 20px;
    padding: 10px 25px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }
  th, td {
    border: 1px solid #aaa;
    padding: 8px;
    font-size: 14px;
  }
  th {
    background: #eee;
  }
</style>
</head>
<body>

<h2>Ø³Ø§Ù…Ø§Ù†Ù‡ Ú©Ø¯Ú¯Ø°Ø§Ø±ÛŒ ÙˆØ³Ø§ÛŒÙ„ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù‚ÙØ³Ù‡</h2>

<button class="search-btn" type="button" onclick="searchItems()">ğŸ” Ø¬Ø³ØªØ¬Ùˆ</button>
<button class="export-btn" type="button" onclick="exportToExcel()">ğŸ“¥ Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„</button>

<div class="container">
  <form id="itemForm" onsubmit="return addItem(event)">
    <label for="shelfNumber">Ø´Ù…Ø§Ø±Ù‡ Ù‚ÙØ³Ù‡:</label>
    <input type="text" id="shelfNumber" name="shelfNumber" required />

    <label for="itemNumber">Ø´Ù…Ø§Ø±Ù‡ ÙˆØ³ÛŒÙ„Ù‡:</label>
    <input type="number" id="itemNumber" name="itemNumber" required />

    <label for="itemQuantity">Ù…Ù‚Ø¯Ø§Ø±:</label>
    <input type="number" id="itemQuantity" name="itemQuantity" placeholder="" min="0" step="any" />

    <label for="itemUnit">ÙˆØ§Ø­Ø¯:</label>
    <input type="text" id="itemUnit" name="itemUnit" placeholder="" />

    <label for="itemName">Ù†Ø§Ù… ÙˆØ³ÛŒÙ„Ù‡:</label>
    <input type="text" id="itemName" name="itemName" required />

    <label for="itemModel">Ù…Ø¯Ù„ ÙˆØ³ÛŒÙ„Ù‡:</label>
    <input type="text" id="itemModel" name="itemModel" />

    <button type="submit" title="Ø«Ø¨Øª ÙˆØ³ÛŒÙ„Ù‡">Ø«Ø¨Øª ÙˆØ³ÛŒÙ„Ù‡ â•</button>
  </form>
</div>

<table id="itemsTable" dir="rtl">
  <thead>
    <tr>
      <th>Ú©Ø¯ ÙˆØ³ÛŒÙ„Ù‡</th>
      <th>Ø´Ù…Ø§Ø±Ù‡ Ù‚ÙØ³Ù‡</th>
      <th>Ø´Ù…Ø§Ø±Ù‡ ÙˆØ³ÛŒÙ„Ù‡</th>
      <th>Ù…Ù‚Ø¯Ø§Ø±</th>
      <th>ÙˆØ§Ø­Ø¯</th>
      <th>Ù†Ø§Ù… ÙˆØ³ÛŒÙ„Ù‡</th>
      <th>Ù…Ø¯Ù„ ÙˆØ³ÛŒÙ„Ù‡</th>
      <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
    </tr>
  </thead>
  <tbody>
    <!-- Ø±Ø¯ÛŒÙ Ù‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒØ´Ù† -->
  </tbody>
</table>

<script>
  let items = [];
  let nextId = 1;

  function addItem(event) {
    event.preventDefault();

    const shelfNumber = document.getElementById('shelfNumber').value.trim();
    const itemNumber = document.getElementById('itemNumber').value.trim();
    const itemQuantity = document.getElementById('itemQuantity').value.trim();
    const itemUnit = document.getElementById('itemUnit').value.trim();
    const itemName = document.getElementById('itemName').value.trim();
    const itemModel = document.getElementById('itemModel').value.trim();

    if (!shelfNumber || !itemNumber || !itemName) {
      alert('Ù„Ø·ÙØ§ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯.');
      return false;
    }

    items.push({
      id: nextId++,
      shelfNumber,
      itemNumber,
      itemQuantity,
      itemUnit,
      itemName,
      itemModel
    });

    renderTable(items);
    event.target.reset();
    return false;
  }

  function renderTable(list) {
    const tbody = document.querySelector('#itemsTable tbody');
    tbody.innerHTML = '';

    list.forEach(item => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${item.id}</td>
        <td>${item.shelfNumber}</td>
        <td>${item.itemNumber}</td>
        <td>${item.itemQuantity || '-'}</td>
        <td>${item.itemUnit || '-'}</td>
        <td>${item.itemName}</td>
        <td>${item.itemModel || '-'}</td>
        <td><button onclick="deleteItem(${item.id})">Ø­Ø°Ù</button></td>
      `;
      tbody.appendChild(tr);
    });
  }

  function deleteItem(id) {
    items = items.filter(i => i.id !== id);
    renderTable(items);
  }

  function searchItems() {
    const searchTerm = prompt('Ø´Ù…Ø§Ø±Ù‡ Ù‚ÙØ³Ù‡ØŒ Ù†Ø§Ù… ÙˆØ³ÛŒÙ„Ù‡ØŒ Ù…Ù‚Ø¯Ø§Ø± ÛŒØ§ ÙˆØ§Ø­Ø¯ Ø¨Ø±Ø§ÛŒ Ø¬Ø³ØªØ¬Ùˆ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:');
    if (searchTerm !== null) {
      const term = searchTerm.trim().toLowerCase();
      const filtered = items.filter(i =>
        i.shelfNumber.toLowerCase().includes(term) ||
        i.itemName.toLowerCase().includes(term) ||
        (i.itemQuantity && i.itemQuantity.toString().toLowerCase().includes(term)) ||
        (i.itemUnit && i.itemUnit.toLowerCase().includes(term))
      );
      if(filtered.length === 0){
        alert('Ù…ÙˆØ±Ø¯ÛŒ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯.');
      }
      renderTable(filtered);
    }
  }

  function exportToExcel() {
    if(items.length === 0) {
      alert('Ù‡ÛŒÚ† Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.');
      return;
    }
    const headers = ['Ú©Ø¯ ÙˆØ³ÛŒÙ„Ù‡', 'Ø´Ù…Ø§Ø±Ù‡ Ù‚ÙØ³Ù‡', 'Ø´Ù…Ø§Ø±Ù‡ ÙˆØ³ÛŒÙ„Ù‡', 'Ù…Ù‚Ø¯Ø§Ø±', 'ÙˆØ§Ø­Ø¯', 'Ù†Ø§Ù… ÙˆØ³ÛŒÙ„Ù‡', 'Ù…Ø¯Ù„ ÙˆØ³ÛŒÙ„Ù‡'];
    const rows = items.map(item => [
      item.id,
      item.shelfNumber,
      item.itemNumber,
      item.itemQuantity || '',
      item.itemUnit || '',
      item.itemName,
      item.itemModel || ''
    ]);

    let csvContent = '\uFEFF'; // BOM for Excel UTF-8
    csvContent += headers.join(',') + '\n';

    rows.forEach(rowArray => {
      // Ø§Ú¯Ø± Ù‡Ø± ÙÛŒÙ„Ø¯ Ø´Ø§Ù…Ù„ Ú©Ø§Ù…Ø§ Ø¨ÙˆØ¯ØŒ Ø¨Ø§ "" Ø¯ÙˆØ±Ø´ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
      const row = rowArray.map(field => {
        if (typeof field === 'string' && field.includes(',')) {
          return `"${field}"`;
        }
        return field;
      }).join(',');
      csvContent += row + '\n';
    });

    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = 'items_export.csv';
    link.style.display = 'none';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  }
</script>

</body>
</html>
